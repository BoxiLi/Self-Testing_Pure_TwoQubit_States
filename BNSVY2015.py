#############################################################################################
#                                                                                           #
# This file contains data as displayed in Fig.5 of the paper                                #
# "Physical characterization of quantum devices from nonlocal correlations" (2015)          #
# by Jean-Daniel Bancal, Miguel Navascués, Valerio Scarani, Tamás Vértesi, Tzyh Haur Yang   #
#                                                                                           #
# DOI: 10.1103/PhysRevA.91.022115                                                           #
# URL: https://journals.aps.org/pra/abstract/10.1103/PhysRevA.91.022115                     #
#                                                                                           #
#############################################################################################

import tiltedCHSH
import math

_lowbounds = {}

_lowbounds[0] = \
    [0.07322527802, 0.08345097562, 0.09370342056, 0.103982742, 0.1142899624,
     0.1246236085, 0.1349846693, 0.1453690662, 0.1557831341, 0.1662234813,
     0.1766902821, 0.1871844, 0.1977037069, 0.2082501802, 0.2188245722,
     0.2294234834, 0.2400489152, 0.2507024905, 0.2613814193, 0.2720851452,
     0.2828166945, 0.2935730826, 0.3043564742, 0.3151660303, 0.3259997927,
     0.3368601879, 0.3477474098, 0.3586589306, 0.3695965476, 0.3805585877,
     0.391547238, 0.4025607444, 0.4135992391, 0.4246621423, 0.4357518892,
     0.4468630308, 0.4580009022, 0.4691619019, 0.4803491895, 0.4915576889,
     0.5027915317, 0.5140494431, 0.5253313068, 0.5366364096, 0.5479655296,
     0.5593145324, 0.5706871591, 0.5820829024, 0.5935006433, 0.604940266,
     0.6164007971, 0.6278849213, 0.6393858146, 0.6509103902, 0.6624534703,
     0.6740176886, 0.6855995286, 0.69720016, 0.7088190498, 0.7204580391,
     0.7321125095, 0.7437818782, 0.7554731667, 0.767174067, 0.778888786,
     0.7906191913, 0.8023521986, 0.8140871494, 0.8258244715, 0.8375583535,
     0.8492922341, 0.8610286724, 0.8727638557, 0.8844968476, 0.896231943,
     0.907968431, 0.9197031343, 0.9314381567, 0.9431744523, 0.9549082749,
     0.9666441693, 0.9783784568, 0.9901122574]


_lowbounds[0.5] = \
    [0.06462545985, 0.06515162522, 0.0656821341, 0.06620982679, 0.06673692857,
     0.06726581288, 0.0677938299, 0.06832138518, 0.06885259109, 0.06937896339,
     0.06990601181, 0.07043432506, 0.07096257119, 0.07148996196, 0.07201789207,
     0.07254944587, 0.07307500638, 0.0736038223, 0.07413151625, 0.07465916574,
     0.07518819892, 0.07571685056, 0.07624415669, 0.07677289879, 0.07730134033,
     0.07782930623, 0.07835647686, 0.07888499342, 0.07941378548, 0.07994280222,
     0.08046930892, 0.08099819911, 0.08152652838, 0.08205559684, 0.08258378305,
     0.08311167764, 0.08363934514, 0.08416684253, 0.08469491154, 0.0852233602,
     0.08575257847, 0.08628102892, 0.08680734282, 0.08733685475, 0.08786551413,
     0.08839289778, 0.08892413918, 0.08945580885, 0.08997725601, 0.09050517163,
     0.09103230785, 0.1129107096, 0.1347888406, 0.1566661737, 0.1785447453,
     0.2004226841, 0.2223000825, 0.2441784548, 0.2660553338, 0.2879335625,
     0.3098110393, 0.3316892553, 0.3535671207, 0.3754444765, 0.397322175,
     0.4191999236, 0.4410779709, 0.4629556318, 0.484833451, 0.5067111496,
     0.5285887811, 0.5504670118, 0.5723446188, 0.5942259059, 0.6161006068,
     0.6379773273, 0.6598552192, 0.6817329206, 0.7036102519, 0.7254882159,
     0.747366468, 0.7692438466, 0.791121985, 0.8129992801, 0.8348772188,
     0.856754663, 0.8786337102, 0.9005108858, 0.9223881867, 0.9442672356,
     0.9661440439, 0.9880211674]


_lowbounds[1] = \
    [0.04877837684, 0.04914228869, 0.04950928625, 0.04989266579, 0.05024442274,
     0.05061127916, 0.05097767908, 0.05134282836, 0.05171057415, 0.05207920769,
     0.05244353538, 0.05281248516, 0.05317732819, 0.05354667325, 0.05391308812,
     0.05428156123, 0.05464624199, 0.05501222849, 0.0553810365, 0.05574676995,
     0.05611424051, 0.05648493873, 0.05684856551, 0.0572142014, 0.05758141096,
     0.05795009569, 0.05831713101, 0.05868370217, 0.05905028654, 0.05941684727,
     0.05978328096, 0.06015193594, 0.06051919725, 0.06088469486, 0.06125215297,
     0.06161913137, 0.06198467962, 0.06235282154, 0.06272099827, 0.06308728028,
     0.06345465926, 0.06382373224, 0.06418713341, 0.06455435523, 0.06492133238,
     0.06528881126, 0.06565566505, 0.06602266708, 0.06639076254, 0.06675731395,
     0.06712373694, 0.06749024061, 0.06785699322, 0.0682237005, 0.06859128136,
     0.06895880528, 0.06932549551, 0.06969324246, 0.07005883511, 0.07042608914,
     0.07079338653, 0.07116244069, 0.07152815175, 0.07189376119, 0.07226229489,
     0.07262847214, 0.07299621722, 0.07336269989, 0.07372946479, 0.074096501,
     0.07446318454, 0.07483034706, 0.07519786083, 0.07556521113, 0.07593067719,
     0.07629885171, 0.07666630929, 0.07703336376, 0.07740048435, 0.07776739933,
     0.0781326203, 0.07850059342, 0.07886964824, 0.07923413929, 0.07960187912,
     0.07996870796, 0.08033500433, 0.08070214744, 0.08107044004, 0.0814360986,
     0.08180395437, 0.08217030706, 0.08253712224, 0.08290493955, 0.08327142164,
     0.083637195, 0.08400603913, 0.08437234923, 0.08473910148, 0.08510576626,
     0.08547250776, 0.1418297806, 0.1981853745, 0.2545416928, 0.3108979075,
     0.3672537626, 0.4236090933, 0.4799653358, 0.536321376, 0.5926761584,
     0.6490330148, 0.7053882629, 0.7617434081, 0.818099081, 0.8744548599,
     0.930810738, 0.9871655033]


def lower_bounds(alpha, also_if_trivial=True):

    if alpha not in [0., 0.5, 1.]:
        raise Exception("In the work by Bancal et al. (2015), lower bounds were computed for alpha among {0, 0.5, 1}. Please pass one of these values as parameter.")

    if also_if_trivial:
        return _lowbounds[alpha]
    else:
        trivial_lower_bound = tiltedCHSH.trivial_lower_bound(alpha=alpha)    
        new_lowbounds = [value for value in _lowbounds[alpha] if value > trivial_lower_bound]
        return new_lowbounds


def violations(alpha, also_if_trivial=True):
    violations = tiltedCHSH.betas(alpha=alpha)
    if also_if_trivial:
        return violations
    lowbounds = lower_bounds(alpha=alpha, also_if_trivial=False)
    num_lowbounds = len(lowbounds)
    num_violations = len(violations)
    return violations[num_violations - num_lowbounds :]

